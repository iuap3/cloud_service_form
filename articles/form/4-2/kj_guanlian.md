## 如何使用关联控件？

“关联”控件，是和用友云表单1.0提供的控件，它所提供的功能是，在填表单时，可以将其他表单中的数据引用过来，做为本表单的数据。

举个例子：



![](/articles/form/4-2/images/image_gl01.png)


图一



如图一所示的员工宿舍申请单中，宿舍类型和期望入住宿舍有两种做法。

一种做法是使用选项控件和文本控件，选择加手工录入的方式，选择宿舍分类，录入宿舍资源。设计态如图二所示。运行态如图三所示。

![](/articles/form/4-2/images/image_gl02.png)


图二



![](/articles/form/4-2/images/image_gl03.png)


图三



这种方法在录单时比较烦琐，制单人需要录入比较多的字，而且还容易录错。

另外一种做法就是使用关联控件。将宿舍分类和宿舍资源分别做成一个表单，将所有的宿舍分类和资源录入到表单中。在员工宿舍申请单中，关联这两个表单，引用其中的数据。

下面我们就来看下，如何使用关联控件。

首先，定制一个宿舍分类表（如图四）和一个宿舍资源表单（如图六），然后将所有的宿舍分类（如图五）及宿舍资源（如图七）录入到表单中，员工在申请宿舍时，会直接从宿舍资源表中选择中意的宿舍。

定义宿舍分类表及宿舍资源表时，需要将设计器表单页签中的“可以被其他表单关联引用”属性勾选上，如图四、图六中红框圈出的部分。

![](/articles/form/4-2/images/image_gl04.png)


图四

![](/articles/form/4-2/images/image_gl05.png)


图五

![](/articles/form/4-2/images/image_gl06.png)


图六

![](/articles/form/4-2/images/image_gl07.png)


图七

其次，我们改造一下之前图二的员工宿舍申请单，将图中的宿舍分类的选项控件改为关联控件，期望入住宿舍的文本控件也改为关联控件。

图八是关联控件的属性，中间红框圈出的部分是关联控件特有的属性。

![](/articles/form/4-2/images/image_gl08.png)


图八

其中：

点击选择“要关联的表单或对象”的下拉框，弹出如图九所示的窗口，这个窗口有两个页签，用户和系统，默认显示“用户”页签。用户页签显示的是表单定义时勾选了“允许被其他表单关联引用”的表单，比如我们前面已经定义的宿舍分类及宿舍资源；而系统页签显示的是系统定义的可以被其他表单引用的表单，比如用户及用户组。通常系统页签的可以被其他表单引用的表单为了方便使用，会被做成一个控件。

![](/articles/form/4-2/images/image_gl09.png)


图九



这里我们选择“宿舍分类”后，界面如图十，红框标记的两个地方发生了变化，一个是控件名称，选择完关联表单后，控件的名称自动变为关联的表单名称；二是在属性区域，选择完关联表单后，在其下面一行会出现选择显示字段的信息。

![](/articles/form/4-2/images/image_gl10.png)


图十



下面我们来定义显示字段，这里定义的显示字段，用来控制两个地方：一个是运行态填表单，点开“宿舍分类”后的弹出窗口中的显示字段，它是用列表展现的，如图十一；另一个是在前面的列表中选择完数据后，在表单中显示的内容，如图十二所示。

![](/articles/form/4-2/images/image_gl11.png)


图十一



![](/articles/form/4-2/images/image_gl12.png)


图十二



在图十中，点击标记②的“选择字段”，弹出的窗口如图十三所示，这里列出来的是“宿舍分类”表单中的所有字段，勾选显示字段，比如这里的“分类名称”。

![](/articles/form/4-2/images/image_gl13.png)


图十三



选完显示字段后，选中的字段列示在“显示字段”的下方，如图十四所示，点击字段旁边的垃圾桶可以删除显示字段。

![](/articles/form/4-2/images/image_gl14.png)


图十四



没有其他特别的要求的话，关联控件就设置好了。

同样的方法，设置另一个关联控件“宿舍资源”。设置后的结果如图十五。这个关联控件中，显示字段设置了2个，运行态宿舍资源的显示格式，是按“字段1_字段2”来显示的，如图十六所示。

![](/articles/form/4-2/images/image_gl15.png)


图十五



![](/articles/form/4-2/images/image_gl16.png)


图十六



如果我们在设计器上，设置了“关联多条数据”，如图十七所示，运行态待选数据如图十八所示，选中后的显示样式如图十九所示。

![](/articles/form/4-2/images/image_gl17.png)


图十七



![](/articles/form/4-2/images/image_gl18.png)


图十八



![](/articles/form/4-2/images/image_gl19.png)


图十九
