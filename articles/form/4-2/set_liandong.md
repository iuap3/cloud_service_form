## 如何设置两个关联控件间的联动

用友云表单V3.0除了增加了一些新控件外，还提升了一些控件自身的功能，关联控件就是其中之一，新的关联控件较之前版本增加了联动功能。

什么是关联的联动呢？说的通俗一点就是两个关联控件之间有一定的依赖关系，第二个关联控件中的数据是通过第一个关联控件中数据过滤得到的。

比较常见的用法：

在填写地址的场景下，通常是给出省、市、区县、详细地址，这样的格式来填写。先选择省（比如山东省），然后再根据选中的省来过滤下面的市（根据山东省过滤省辖市，比如济南市、青岛市等），再根据市来过滤下面的区县（根据选中的济南市来过滤下面的市辖区/县，比如市中区、历城区、历下区、平阴县等）；

在员工填请假单的场景，可能是员工自己登录系统填写请假单，也可能是由部门的文员登录系统统一为部门的所有人填请假单。第二种情况下，会有一个需求，希望选择完部门后再选员工时，看到的是前面选中部门下的员工，而不是所有员工；

在填写办公用品领用单中，先选择办公用品分类（比如笔），然后再根据分类过滤出这个分类下的办公用品（比如签字笔、白板笔等等）；

……

等等，都是类似的用法。

下面我们就以之前用到的员工宿舍申请单为例，来看下联动的设置方法：

![](/articles/form/4-2/images/image_gl01.png)

图一



在这张员工宿舍申请单中，“宿舍类型”使用关联控件，对应的表单是“宿舍类型”，如图二；“期望入住宿舍”使用关联控件，对应表单是“宿舍资源”，如图三。

![](/articles/form/4-2/images/image_setgl02.png)

图二


![](/articles/form/4-2/images/image_setgl03.png)


图三



![](/articles/form/4-2/images/image_setgl04.png)


图四



员工宿舍申请单如图四所示，当前选中控件是关联控件——期望入住宿舍。

图中的红色标注：



① 关联控件“宿舍类型”，关联的是“宿舍类型”表，显示“类型名称”；



② 关联控件“期望入住宿舍”关联的是“宿舍资源”表，控件名称默认为关联的表单名称，手工修改为“期望入住宿舍”；



③ 设置关联控件关联的表单——“宿舍资源”；



④ 设置关联控件的显示字段——宿舍名称、宿舍地址；



⑤ 设置当前关联控件是否需要联动；当勾选了“设置联动”后，还需要设置“要联动的控件”和“联动过滤字段”，如图五所示。

![](/articles/form/4-2/images/image_setgl05.png)


图五



![](/articles/form/4-2/images/image_setgl06.png)


图六



1、选择要联动的控件：设置当前控件要与哪个控件发生联动，目前版本只支持关联控件与关联控件之间的联动。所以，下拉框内列出的是当前表单内的，除了当前选中的关联控件以外的关联控件，且关联的表单或对象为“用户”页签下的表单（如图六）。

我们的例子中，“期望入住宿舍”与“宿舍类型”产生联动，这里设置为“宿舍类型”。



2、设置联动过滤字段：设置两个关联控件之间通过哪个字段进行过滤。下拉框内列出的是当前关联控件关联的表单中的所有字段（如图七所示）。

我们的例子中，宿舍资源表与宿舍类型表通过表单中的“宿舍资源”进行过滤，过滤字段列出的是“宿舍资源”表中的所有字段。这里设置为“宿舍类型”（如图八所示）。

![](/articles/form/4-2/images/image_setgl07.png)

图七

![](/articles/form/4-2/images/image_setgl08.png)


图八



设置完成后，点“保存并启用”按钮，运行态的效果如图九所示。宿舍类型选择了“三人间”后再点开期望入住宿舍，在弹出的窗口中只显示出了宿舍类型为三人间的宿舍资源。

![](/articles/form/4-2/images/image_setgl09.png)

图九
